services:
  ntfy:
    image: binwiederhier/ntfy:latest
    command: serve
    restart: unless-stopped
    volumes:
      - ./cache:/var/cache/ntfy
      - ./config:/etc/ntfy
    environment:
      - TZ=Europe/Berlin
    networks:
      - proxy
    labels:
      - traefik.enable=true

      # Router (subdomain)
      - traefik.http.routers.ntfy.rule=Host(`ntfy.${DOMAIN}`)
      - traefik.http.routers.ntfy.entrypoints=websecure
      - traefik.http.routers.ntfy.tls=true

      # If your Traefik uses Let's Encrypt via a certresolver, keep the same name here:
      - traefik.http.routers.ntfy.tls.certresolver=letsencrypt

      # Tell Traefik what port ntfy listens on INSIDE the container
      - traefik.http.services.ntfy.loadbalancer.server.port=80

networks:
  proxy:
    external: true
    name: proxy
